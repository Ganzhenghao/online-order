<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <title>首页</title>
    </head>

    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" />
    <link rel="stylesheet" th:href="@{/fonts/iconfont.css}" />
    <script type="text/javascript" th:src="@{/js/jquery-3.3.1.js}" ></script>
    <script type="text/javascript" th:src="@{/js/bootstrap.min.js}" ></script>

    <body style="background: #FF7600;">
        <div th:include="common/top :: top"></div>
        <div class="container" style="margin-top: 50px;">
            <div class="row" style="background: white;height: 70px;padding: 30px 0px 0px 20px;font-size: 16px;color: #898989;">
                <p style="float: left;">搜索结果</p>
            </div>
            <div class="row" style="background: white;height: 1300px;padding: 30px 0px 0px 20px;font-size: 16px;margin-top: 15px;color: #898989;">
                <div class="col-md-3" th:each="merchant,status : ${pageVo.data}">
                    <a th:href="'/user/merchantDetail/' + ${merchant.merchantId} + '/1/16'"><img th:src="${merchant.merchantImg}" width="230px" height="150px"/></a>
                    <p style="color: #060A15;margin-top: 6px;">
                        <img class="img-circle" th:src="${merchant.merchantImg}" width="30px" height="30px" alt="" />
                        <span th:text="${merchant.merchantName}"></span>
                    </p>
                    <p style="font-size: 5px;float: left;">起送:￥<span th:text="${merchant.minConsume}"></span></p>
                    <p style="font-size: 5px;float:left;margin-left: 40px;">配送费:￥<span th:text="${merchant.deliveryCost}"></span></p>
                    <p style="font-size: 5px;float:left;color: #CB8A8E;margin-left: 40px;">出售<span th:text="${merchant.sell}"></span>单</p><br />
                    <hr style="color: black;" />
                </div>
                <div class="col-md-12">
                    <ul class="pagination pagination-sm pull-right">
                        <td th:switch = "${pageVo.pages > 6}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/1/16/'" style="color: #333333;margin-left: 10px;">...1</a></li>
                        </td>
                        <td th:switch = "${pageVo.page > 1}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page - 1} + '/16/'" style="color: #333333;margin-left: 10px;border-radius: 0px;">&laquo;</a></li>
                        </td>
                        <td th:switch = "${pageVo.page  - 5 > 0}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page - 5} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} - 5"></a></li>
                        </td>
                        <td th:switch = "${pageVo.page  - 4 > 0}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page - 4} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} - 4"></a></li>
                        </td>
                        <td th:switch = "${pageVo.page  - 3 > 0}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page - 3} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} - 3"></a></li>
                        </td>
                        <td th:switch = "${pageVo.page  - 2 > 0}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page - 2} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} - 2"></a></li>
                        </td>
                        <td th:switch = "${pageVo.page  - 1 > 0}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page - 1} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} - 1"></a></li>
                        </td>
                        <li><a href="#" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page}"></a></li>
                        <td th:switch = "${pageVo.page  + 1 <= pageVo.pages}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page + 1} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} + 1"></a></li>
                        </td>
                        <td th:switch = "${pageVo.page  + 2 <= pageVo.pages}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page + 2} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} + 2"></a></li>
                        </td>
                        <td th:switch = "${pageVo.page  + 3 <= pageVo.pages}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page + 3} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} + 3"></a></li>
                        </td>
                        <td th:switch = "${pageVo.page  + 4 <= pageVo.pages}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page + 4} + '/16/'" style="color: #333333;margin-left: 10px;" th:text="${pageVo.page} + 4"></a></li>
                        </td>
                        <td th:switch = "${pageVo.pages - pageVo.page > 5}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.pages} + '/16/'" style="color: #333333;margin-left: 10px;">...<span th:text="${pageVo.pages}"></span></a></li>
                        </td>
                        <li><a style="color: #333333;margin-left: 10px;"><input th:attr="merchantName=${merchantName}" id="jump" type="text" style="width: 30px;height: 18px;"/> / <span th:text="${pageVo.pages} + '页'"></span></a></li>
                        <td th:switch = "${pageVo.page < pageVo.pages}">
                            <li th:case="true"><a th:href="'/user/search/' + ${merchantName} + '/' + ${pageVo.page + 1} + '/16/'" style="color: #333333;margin-left: 10px;border-radius: 0px;">&raquo;</a></li>
                        </td>
                    </ul>
                </div>
            </div>


        </div>
        <!--底部-->
        <div th:include="common/bottom :: bottom"></div>
        <script type="text/javascript" th:src="@{/js/common.js}" ></script>
        <script type="text/javascript">
            $(document).keyup(function(event){
                if(event.keyCode == 13){
                    var jump = $("#jump").val();
                    var merchantName = $("#merchantName").val();
                    window.location.href = "/user/search/" + merchantName + "/" + jump + "/16"
                }
            });
            $(function() {
                $("#username").blur(function() {
                    var username = $("#username").val();
                    if (!(username.length > 5 && username.length < 17)) {
                        alert("请输入6-16位用户名!");
                    }
                });
                $("#password").blur(function() {
                    var password  = $("#password").val();
                    if (!(password.length > 5 && password.length < 17)) {
                        alert("请输入6-16位密码!");
                    }
                });
                $("#login_btn").click(function(){
                    var username = $("#username").val();
                    var password = $("#password").val();
                    if (!(username.length > 5 && username.length < 17)) {
                        $("#username").focus();
                    } else if (!(password.length > 5 && password.length < 17)) {
                        $("#password").focus();
                    } else {
                        $.ajax({
                            type:"post",
                            url:"/user/login",
                            data:$("#login_form").serialize(),
                            dataType: "json",
                            success:function(data) {
                                if (data.status == 200) {
                                    window.location.href="/";
                                } else {
                                    if (data.desc != null) {
                                        alert(data.desc);
                                    }
                                }
                            }
                        });
                    }
                });
            });

            // 验证邮箱是否合法
            function legalEmail(email) {
                var reg = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;
                return reg.test(email) ? true : false;
            }
        </script>
    </body>
</html>